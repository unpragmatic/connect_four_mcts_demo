parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"kpde":[function(require,module,exports) {
"use strict";function t(t){return a(t)||n(t)||r(t)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function n(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function a(t){if(Array.isArray(t))return o(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function E(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConnectFourGame=exports.Constants=void 0,exports.Constants={COLUMNS:7,ROWS:6,ALL_COLUMNS_INDICES:[0,1,2,3,4,5,6],ALL_ROW_INDICES:[0,1,2,3,4,5],TURN_TO_TILE_MAP:{PLAYER_1_TURN:"PLAYER_1",PLAYER_2_TURN:"PLAYER_2"}};var u=function(){function e(){i(this,e),this.board=[["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"]],this.gameState="PLAYER_1_TURN",this.moveHistory=[],this.gameStateHistory=["PLAYER_1_TURN"]}return E(e,[{key:"isOver",value:function(){return"PLAYER_1_TURN"!=this.gameState&&"PLAYER_2_TURN"!=this.gameState}},{key:"moveIsValid",value:function(t){return"EMPTY"==this.board[exports.Constants.ROWS-1][t]}},{key:"validMoves",value:function(){var t=this;return exports.Constants.ALL_COLUMNS_INDICES.filter(function(e){return t.moveIsValid(e)})}},{key:"currentPlayer",value:function(){if(1===this.gameStateHistory.length)return"PLAYER_1";var t=this.gameStateHistory[this.gameState.length-2];return"PLAYER_1_TURN"===t?"PLAYER_2":"PLAYER_2_TURN"===t?"PLAYER_1":void 0}},{key:"playerHasWon",value:function(t){return"PLAYER_1_WIN"===this.gameState&&"PLAYER_1"===t||"PLAYER_2_WIN"===this.gameState&&"PLAYER_2"===t}},{key:"push",value:function(e){var r=this;if(this.isOver())throw new Error("Invalid move. Game is already over.");if(!this.moveIsValid(e))throw new Error("Invalid move. Column is filled.");var n=Math.min.apply(Math,t(exports.Constants.ALL_ROW_INDICES.filter(function(t){return"EMPTY"==r.board[t][e]})));this.board[n][e]=exports.Constants.TURN_TO_TILE_MAP[this.gameState];var a=this._calculateUpdatedGameState(n,e);this.gameState=a,this.moveHistory.push(e),this.gameStateHistory.push(a)}},{key:"pop",value:function(){var e=this;if(0===this.moveHistory.length)throw new Error("Can't undo. No move to undo.");var r=this.moveHistory.pop();this.gameStateHistory.pop();var n=this.gameStateHistory[this.gameStateHistory.length-1],a=Math.max.apply(Math,t(exports.Constants.ALL_ROW_INDICES.filter(function(t){return"EMPTY"!=e.board[t][r]})));this.board[a][r]="EMPTY",this.gameState=n}},{key:"_calculateUpdatedGameState",value:function(t,e){var r=this,n=function(t){for(var e="EMPTY",r=0,n=0;n<t.length;n++)if(t[n]===e?r+=1:(e=t[n],r=1),4===r&&"EMPTY"!==e)return"PLAYER_1"===e?"PLAYER_1_WIN":"PLAYER_2_WIN"},a=n(exports.Constants.ALL_ROW_INDICES.map(function(t){return r.board[t][e]}));if(a)return a;var o=n(exports.Constants.ALL_COLUMNS_INDICES.map(function(e){return r.board[t][e]}));if(o)return o;for(var i=Math.min(t,e),s=e-i,E=t-i,u=[];s<exports.Constants.COLUMNS&&E<exports.Constants.ROWS;)u.push(this.board[E][s]),s+=1,E+=1;var P=n(u);if(P)return P;i=Math.min(exports.Constants.COLUMNS-e,t),s=e+i,E=t-i;for(var Y=[];s>=0&&E<exports.Constants.ROWS;)Y.push(this.board[E][s]),s-=1,E+=1;var T=n(Y);return T||(0==this.validMoves().length?"DRAW":"PLAYER_1_TURN"===this.gameState?"PLAYER_2_TURN":"PLAYER_1_TURN")}}]),e}();exports.ConnectFourGame=u;
},{}],"pr3c":[function(require,module,exports) {
"use strict";function e(e,o){return n(e)||r(e,o)||a(e,o)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(s){o=!0,a=s}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return r}}function n(e){if(Array.isArray(e))return e}function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var v=require("./connect_four"),f=function(){function e(t){u(this,e),this.game=t,this.root=new y(t.validMoves(),void 0)}return l(e,[{key:"search",value:function(){if(!this.game.isOver()){for(var e=0,t=performance.now();performance.now()-t<1e3;){for(var r=0;r<2e3;r++)this.root._search(this.game,c(this.game));e+=2e3}return console.log(e),this.root.expSelectMove()}}}]),e}();function c(e){if("PLAYER_1_TURN"===e.gameState)return"PLAYER_1_WIN";if("PLAYER_2_TURN"===e.gameState)return"PLAYER_2_WIN";throw new Error("Unexpected conditions")}function h(e){for(var t=0;!e.isOver();){var r=e.validMoves(),n=r[Math.floor(Math.random()*r.length)];e.push(n),t+=1}for(var o=e.gameState,a=0;a<t;a++)e.pop();return o}var y=function(){function t(e,r){u(this,t),this.move=r,this.wins=0,this.n=0,this.validMoves=e,this.moveToChildMap=[]}return l(t,[{key:"search",value:function(e){var t=c(e);e.push(this.move);var r=this._search(e,t);return e.pop(),r}},{key:"getMoveChildPairs",value:function(){var e=this;return this.validMoves.map(function(t){return[t,e.moveToChildMap[t]]})}},{key:"ucbSelectMove",value:function(){var t,r=Math.sqrt(2),n=void 0,a=-1/0,i=o(this.getMoveChildPairs());try{for(i.s();!(t=i.n()).done;){var u=e(t.value,2),s=u[0],l=u[1];if(!l)return s;var v=l.wins/l.n+r*Math.sqrt(Math.log(this.n)/l.n);v>a&&(n=s,a=v)}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"expSelectMove",value:function(){var t,r=void 0,n=-1/0,a=o(this.getMoveChildPairs());try{for(a.s();!(t=a.n()).done;){var i=e(t.value,2),u=i[0],s=i[1];if(s){var l=s.wins/s.n;l>n&&(r=u,n=l)}}}catch(v){a.e(v)}finally{a.f()}return r}},{key:"_search",value:function(e,r){if(this.n+=1,e.isOver())return e.gameState===r&&(this.wins+=1),e.gameState;var n=this.ucbSelectMove(),o=this.moveToChildMap[n];if(o){var a=o.search(e);return a===r&&(this.wins+=1),a}var i=c(e);e.push(n);var u=e.validMoves();e.pop(),o=new t(u,n),this.moveToChildMap[n]=o,e.push(n);var s=h(e);return e.pop(),o.n+=1,s===i&&(o.wins+=1),s===r&&(this.wins+=1),s}}]),t}();onmessage=function(e){var t=new v.ConnectFourGame;t.board=e.data.board,t.gameState=e.data.gameState,t.moveHistory=e.data.moveHistory,t.gameStateHistory=e.data.gameStateHistory;var r=new f(t).search();postMessage(r)};
},{"./connect_four":"kpde"}]},{},["pr3c"], null)
//# sourceMappingURL=ai_worker.b26f2194.js.map